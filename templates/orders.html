<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <link rel="shortcut icon" href="/static/images/verve.png" type="image/x-icon">
    <!-- CSS -->
    <link rel="stylesheet" href="/static/css/adminHome.css">
    <!-- BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <!-- GOOGLE FONT LINK -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,200;9..40,300;9..40,400;9..40,500&family=Kalnia:wght@100;200;300;400;500;600&display=swap"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Libre+Caslon+Display&family=Libre+Caslon+Text:ital,wght@0,400;0,700;1,400&display=swap"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sacramento&display=swap" rel="stylesheet">
    <!-- ITALIANA GOOGLE FONT LINK -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Italiana&display=swap" rel="stylesheet">

    <!-- Boxicons CSS and JS -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>

    <!-- CUSTOM JS -->
    <script src="/static/javascript/admin.js" defer></script>

    <!-- FONTAWESOME LINk -->
    <script src="https://kit.fontawesome.com/226d183df1.js" crossorigin="anonymous"></script>
    <!-- highlighter -->
    <svg xmlns="//www.w3.org/2000/svg" version="1.1" class="svg-filters" style="display:none;">
        <defs>
            <filter id="marker-shape">
                <feTurbulence type="fractalNoise" baseFrequency="0 0.15" numOctaves="1" result="warp" />
                <feDisplacementMap xChannelSelector="R" yChannelSelector="G" scale="30" in="SourceGraphic" in2="warp" />
            </filter>
        </defs>
    </svg>
    <!-- JQUERY LINK -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

</head>

<body>

    <nav class="sidebar close">
        <header>
            <div class="image-text">
                <span class="image">
                    <img src="/static/images/verve.png" alt="">
                </span>
                <div class="text logo-text">
                    <span class="name">Verve</span>
                    <span class="profession">The Thrift Store</span>
                </div>
            </div>
            <i class='bx bx-chevron-right toggle'></i>
        </header>
        <div class="menu-bar">
            <div class="menu">
                <li class="search-box">
                    <i class='bx bx-search icon'></i>
                    <input type="text" placeholder="Search...">
                </li>
                <ul class="menu-links ">
                    <li class="nav-link active-link">
                        <a href="/admin-home">
                            <i class='bx bx-home-alt icon'></i>
                            <span class="text nav-text">Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-link">
                        <a href="/order-data">
                            <i class='bx bx-bell icon'></i>
                            <span class="text nav-text">Orders Placed</span>
                        </a>
                    </li>
                    <li class="nav-link">
                        <a href="/order-completed-data">
                            <i class='bx bx-badge-check icon'></i>
                            <span class="text nav-text">Completed</span>
                        </a>
                    </li>
                    <li class="nav-link">
                        <a href="/order-incomplete-data">
                            <i class='bx bx-message-alt-x icon'></i>
                            <span class="text nav-text">Incomplete</span>
                        </a>
                    </li>
                    <li class="nav-link">
                        <a href="/user-feedback">
                            <!-- <i class='bx bx-pie-chart-alt icon'></i> -->
                            <i class='bx bx-message-square-dots icon'></i>
                            <span class="text nav-text">User Feedback</span>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="bottom-content">
                <li class="">
                    <a href="/admin-logout">
                        <i class='bx bx-log-out icon'></i>
                        <span class="text nav-text">Logout</span>
                    </a>
                </li>
                <li class="mode">
                    <div class="sun-moon">
                        <i class='bx bx-moon icon moon'></i>
                        <i class='bx bx-sun icon sun'></i>
                    </div>
                    <span class="mode-text text">Dark mode</span>
                    <div class="toggle-switch">
                        <span class="switch"></span>
                    </div>
                </li>

            </div>
        </div>
    </nav>
    <section class="home">

        <div class="orderData-Section" id="orders-placed">
            <div class="d-flex" style="justify-content: flex-start; align-items: center;">
                <h2>Orders All</h2>
                <div class="d-flex mybtnflexer" style="height: 30px;">
                    <button type="button" class="btn btn-outline-info mx-1" onclick="incompleteOrder()">Incomplete
                        Orders <span class="badge text-bg-danger mx-1">{{ incomplete_count }}</span></button>
                    <button type="button" class="btn btn-outline-success mx-1" onclick="completeOrder()">Complete
                        Orders <span class="badge text-bg-dark mx-1">{{ complete_count }}</span></button>
                </div>
            </div>
            {% if error_message %}
            <div class="alert alert-primary d-flex align-items-center" role="alert" style="height: 70px; width: 90%;">
                <svg xmlns="http://www.w3.org/2000/svg" class="bi bi-exclamation-triangle-fill flex-shrink-0 me-2"
                    viewBox="0 0 16 16" role="img" aria-label="Warning:">
                    <path
                        d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
                </svg>
                <div>
                    {{error_message}}
                </div>
            </div>
            {% endif %}
            <table class="mb-5">
                <thead>
                    <tr>
                        <th>Product Image</th>
                        <th>Order Id</th>
                        <th>Product Id</th>
                        <th>Product Name</th>
                        <th>Price</th>
                        <th>Ordered By</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in orders %}
                    {% for product in order.products %}
                    <tr>
                        <td><img src="{{ product.image_path }}" alt="Product Image"
                                style="width: 60px; border-radius: 50%; margin: 0;"></td>
                        <td>{{ order.order_id }}</td>
                        <td>{{ product.product_id }}</td>
                        <td>{{ product.productname }}</td>
                        <td>â‚¹.{{ product.price }}</td>
                        <td>{{ order.orderedBy }}</td>
                        <div class="d-flex statusEdit">
                            <td
                                class="status-cell {% if order.status == 'Completed' %} completed {% elif order.status == 'Incomplete' %} incomplete {% endif %}">
                                <span>{{ order.status }}</span>
                                <i class='bx bx-edit-alt' title="Edit Status"></i>
                                <div class="dropdown-menu" aria-labelledby="statusDropdown">
                                    <form action="/order-status/{{ order.order_id }}" method="POST">
                                        <input type="hidden" name="action" value="completed">
                                        <button class="dropdown-item" type="submit"
                                            title="order completed">Completed</button>
                                    </form>
                                    <form action="/order-status/{{ order.order_id }}" method="POST">
                                        <input type="hidden" name="action" value="Incomplete">
                                        <button class="dropdown-item" type="submit"
                                            title="order incomplete">Incomplete</button>
                                    </form>
                                </div>
                            </td>
                        </div>
                    </tr>
                    {% endfor %}
                    {% endfor %}
                </tbody>
            </table>

        </div>
    </section>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script>
        $(document).ready(function () {
            $('.dropdown-toggle').on('click', function () {
                $(this).next('.dropdown-menu').toggleClass('show');
            });
        });

        function incompleteOrder() {
            window.location.href = "/order-incomplete-data"
        }

        function completeOrder() {
            window.location.href = "/order-completed-data"
        }

    </script>
</body>

</html>